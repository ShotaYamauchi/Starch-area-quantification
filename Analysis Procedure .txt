Starch Area Quantification Using X-net
 
Code to quantify the starch granule area of stomatal guard cells detected by PS-PI staining, as well as model data for analysis. X-net was used for automatic starch segmentation. Details of the training process are described in the Methods section of Yamauchi et al. 2026.
 
The model was trained on images acquired using a Nikon Digital Eclipse C1 with a 100x objective lens and a field of view of 50.54 x 50.54 µm (digital zoom). When applying this method to images acquired with other confocal microscopes, the results should be validated by comparing them with manual analysis in ImageJ, as described by Flütsch et al. (2018), to ensure accuracy.


 
Preparation for Analysis
 
Download the trained model (model.pth) from GitHub and save the trained model and the folder containing your confocal images to your own Google Drive.
 
Download  starch area quantification code from GitHub and upload the to your Google Colab notebook.
 
Analysis Procedure
 
1. Install packages and grant access permission to Google Drive
Run the cell: %pip install -U --no-cache-dir imagecodecs tifffile
This installs the necessary packages for analysis.
 
Run the cell: from google.colab import drive
This connects the notebook to your Google Drive. You will be asked to grant access; please allow it.
After executing these two codes, follow the authentication prompts. The gdrive directory will appear in the "Files" tab on the left sidebar. This process enables you to read data from and save results to your drive.
 
2. Import libraries and definition
 
Run the code under "Import libraries" to load the necessary libraries.
 
Run the code under "Definition of DataLoader" to define the data loader.
 
Run the code under "Definition of Neural Network model" to define the neural network model.
 
Run from google.colab import drive to mount the drive.
 
3. Specify the path where the images are located
In the code section "① Specify the path where the image exists", replace the empty brackets in list = [] with the path to the folder containing the images to be analyzed.
 
Follow these steps to copy the image path:
 
1. Click the Files icon in the left sidebar.
2. Navigate to drive → MyDrive.
3. Right-click (or open the context menu) on the folder containing your images.
4. Select "Copy path".
5. Paste the path between the brackets in list = [].
 
Run the code: #① Specify the path where the image exists.
 
4. Crop images to 512 x 512 as a preprocessing step
Run the code: #② Crop images to 512x512 as a preprocessing step.
This program crops confocal images to 512 x 512 pixels. The cropped images are saved in a new folder named crop_img within the original image folder.
During execution, the current image path and progress status will be displayed in the output area below the cell.
 
5. Segmentation to identify starch granules
In the code section "③ A program to conduct segmentation", replace the default path in model_path = "model.pth" with the actual directory path where your model is stored.
Example: model_path = "/content/drive/MyDrive/model.pth"
 
How to set the model path:
 
1. Click the Files icon in the left sidebar.
2. Navigate to drive → MyDrive.
3. Find the model file (model.pth) and right-click to open the context menu.
4. Select "Copy path".
5. Paste the path between the quotation marks in model_path = "". Ensure the path is enclosed in quotes.
 
Run the code: #③ A program to conduct segmentation.
Upon execution, folders named segmentation and feature_map will be created within the source directory. The segmentation results and visualization images will be saved in their respective folders.
During execution, the current image path and progress status will be displayed in the output area below the cell.
 
6. Quantification of starch granule area
Run the code: #④ To quantify starch granule area from segmentation image.
Upon execution, the program creates a labeling folder in the source directory to store the analysis result images and text files.
During execution, the current image path and progress status will be displayed in the output area below the cell.
 
7. Calculation of starch granule area
You can find the file labeling_result.txt in the labeling folder. When you open this file in Microsoft Excel:
 
Column A displays the ID numbers of the starch granules identified by segmentation labeling.
Column B shows the calculated area of each granule.
The value in Column B, next to the label "total" in Column A, represents the sum of the starch granule areas within the guard cells.
To determine the actual area (µm²), divide the values obtained from labeling by the pixel density (pixels/µm²) of the analyzed image.
 
Note: If you use data showing multiple stomata in one picture, all starch granules will be detected. Additionally, background fluorescence or mesophyll starch granules may be inadvertently detected. Please check the segmentation and feature map images to avoid erroneous measurements.
 
Contact Information
If you have any questions, please contact:
Dr. Atsushi Takemiya (take.pcs at yamaguchi-u.ac.jp)
Dr. Kazuhiro Hotta (kazuhotta at meijo-u.ac.jp)
Dr. Shota Yamauchi (shyamauchi at rs.tus.ac.jp)
 
Reference
Flütsch S., Distefano L., and Santelia D. Quantification of starch in guard cells of Arabidopsis thaliana. Bio-protocol 8, e2920 (2018).

